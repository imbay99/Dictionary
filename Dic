/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package dictionary2;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Scanner;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.DefaultListModel;
import javax.swing.JOptionPane;
import com.sun.speech.freetts.*;
public class Dictionary extends javax.swing.JFrame {

    /**
     * Creates new form Dictionary
     */
    public Dictionary() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        txtEnglishInput = new javax.swing.JTextField();
        bTranslate = new javax.swing.JButton();
        bSearcher = new javax.swing.JButton();
        bAdd = new javax.swing.JButton();
        txtNewEnglish = new javax.swing.JTextField();
        bRemove = new javax.swing.JButton();
        bUpdate = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        bStart = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        lSearcher = new javax.swing.JList<>();
        lMessege = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        eDictionary = new javax.swing.JEditorPane();
        jScrollPane4 = new javax.swing.JScrollPane();
        eNewVietnamese = new javax.swing.JEditorPane();
        jLabel9 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();

        jLabel5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/dictionary2/bk1.png"))); // NOI18N
        jLabel5.setText("jLabel5");

        jLabel6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/dictionary2/bk1.png"))); // NOI18N
        jLabel6.setText("jLabel6");

        jLabel4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/dictionary2/bk1.png"))); // NOI18N
        jLabel4.setText("jLabel4");

        jLabel7.setIcon(new javax.swing.ImageIcon(getClass().getResource("/dictionary2/bk1.png"))); // NOI18N
        jLabel7.setText("jLabel7");

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setFont(new java.awt.Font("VNI-Cooper", 0, 13)); // NOI18N
        jLabel1.setText("Input :");
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(35, 104, -1, -1));
        getContentPane().add(txtEnglishInput, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 100, 116, -1));

        bTranslate.setText("Translate");
        bTranslate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bTranslateActionPerformed(evt);
            }
        });
        getContentPane().add(bTranslate, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 150, -1, -1));

        bSearcher.setText("Searcher");
        bSearcher.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bSearcherActionPerformed(evt);
            }
        });
        getContentPane().add(bSearcher, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 210, -1, -1));

        bAdd.setText("Add");
        bAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bAddActionPerformed(evt);
            }
        });
        getContentPane().add(bAdd, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 270, -1, -1));
        getContentPane().add(txtNewEnglish, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 480, 100, -1));

        bRemove.setText("Remove");
        bRemove.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bRemoveActionPerformed(evt);
            }
        });
        getContentPane().add(bRemove, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 390, -1, -1));

        bUpdate.setText("Update");
        bUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bUpdateActionPerformed(evt);
            }
        });
        getContentPane().add(bUpdate, new org.netbeans.lib.awtextra.AbsoluteConstraints(100, 330, -1, -1));

        jLabel2.setFont(new java.awt.Font("VNI-Cooper", 0, 13)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(0, 0, 255));
        jLabel2.setText("New English Word");
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 450, -1, -1));

        jLabel3.setFont(new java.awt.Font("VNI-Cooper", 0, 13)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(0, 0, 255));
        jLabel3.setText("New Vietnamese Word");
        getContentPane().add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 510, -1, -1));

        bStart.setFont(new java.awt.Font("Stencil Std", 0, 13)); // NOI18N
        bStart.setForeground(new java.awt.Color(255, 0, 0));
        bStart.setText("Start");
        bStart.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bStartActionPerformed(evt);
            }
        });
        getContentPane().add(bStart, new org.netbeans.lib.awtextra.AbsoluteConstraints(23, 20, -1, -1));

        lSearcher.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lSearcherMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(lSearcher);

        getContentPane().add(jScrollPane3, new org.netbeans.lib.awtextra.AbsoluteConstraints(820, 100, 70, 150));

        lMessege.setFont(new java.awt.Font("VNI-Cooper", 0, 14)); // NOI18N
        lMessege.setForeground(new java.awt.Color(255, 0, 0));
        getContentPane().add(lMessege, new org.netbeans.lib.awtextra.AbsoluteConstraints(440, 70, 230, 20));

        jLabel8.setFont(new java.awt.Font("VNI-Cooper", 0, 14)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(0, 153, 153));
        jLabel8.setText("Vietnamese");
        getContentPane().add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 70, -1, -1));

        eDictionary.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        eDictionary.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                eDictionaryMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(eDictionary);

        getContentPane().add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 100, 530, 720));

        jScrollPane4.setViewportView(eNewVietnamese);

        getContentPane().add(jScrollPane4, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 540, 210, 280));

        jLabel9.setFont(new java.awt.Font("VNI-Cooper", 0, 14)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(0, 204, 204));
        jLabel9.setText("Searcher");
        getContentPane().add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(820, 70, -1, -1));

        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/dictionary2/SoundIcon.png"))); // NOI18N
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(240, 100, 30, 30));

        pack();
    }// </editor-fold>//GEN-END:initComponents
  ArrayList<Word> list;

    public void insertFromFile(String s) throws FileNotFoundException {
        File file = new File(s);
        try (Scanner input = new Scanner(file)) {
            list = new ArrayList<>();
            String str1;
            String str2;
            while (input.hasNext()) {
                str1 = input.next();
                str2 = input.nextLine();
                list.add(new Word(str1, str2));
            }
        }

        Collections.sort(list, (Word w1, Word w2) -> (w1.getWord_target().compareTo(w2.getWord_target())));
    }

    /**
     * Override data to file by path
     *
     * @param s - file path
     * @throws IOException
     */
    public void dictionaryExportToFile(String s) throws IOException {

        File file = new File(s);
        try (PrintWriter pw = new PrintWriter(file)) {
            for (int i = 0; i < list.size(); i++) {
                pw.println(list.get(i).getWord_target().trim() + "\t" + list.get(i).getWord_explain().trim());
            }

        } catch (Exception e) {

        }

    }

    DefaultListModel modelList = new DefaultListModel();

    public void dictionaryLookup(String word1) {
        int count = 0;
        for (int i = 0; i < list.size(); i++) {
            if (word1.equals(list.get(i).getWord_target())) {
                eDictionary.setText(list.get(i).getWord_explain().replaceAll("\\r|\\n", "").trim());
                count++;
                lMessege.setText("Translate Successfully");
                break;
            }
        }
        if (count == 0) {
            lMessege.setText("Your word is not available");
        }
    }

    public void dictionarySearcher() throws FileNotFoundException {
        String word = txtEnglishInput.getText();
        for (int i = 0; i < list.size(); i++) {
            if (list.get(i).getWord_target().indexOf(word) == 0) {
                modelList.addElement(list.get(i).getWord_target() + "\n");
            }
        }
        lSearcher.setModel(modelList);
    }

    /**
     *
     * @param evt
     */
    private void bTranslateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bTranslateActionPerformed
        eDictionary.setText("");
        eDictionary.setContentType("text/html");
        String eInput = txtEnglishInput.getText().trim();
        dictionaryLookup(eInput);
        
        txtNewEnglish.setText("");
        eNewVietnamese.setText("");
    }//GEN-LAST:event_bTranslateActionPerformed
    /**
     * Search Function String word (in dictionatySearcher) : subWord
     *
     * @param evt
     */
    private void bSearcherActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bSearcherActionPerformed
        try {
            modelList.clear();
            if(!txtEnglishInput.getText().isEmpty())
            {dictionarySearcher();}
        } catch (FileNotFoundException ex) {
            Logger.getLogger(Dictionary.class.getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_bSearcherActionPerformed
    /**
     * Add Function eNew : the new English word is added vNew : the new
     * Vietnamese word is added
     *
     * @param evt
     */
    private void bAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bAddActionPerformed
        lMessege.setText("");
        String eNew = txtNewEnglish.getText();
        String vNew = eNewVietnamese.getText();

        if (!vNew.isEmpty() && !eNew.isEmpty()) {
            lMessege.setText("Add Successfully");
            System.out.println("Data load in: " + vNew.replaceAll("\\r\\n|\\r|\\n", " "));
            list.add(new Word(eNew, vNew.replaceAll("\\r\\n|\\r|\\n", " ")));
        } else {
            lMessege.setText("Error");
        }
        try {
            dictionaryExportToFile("dictionary2.txt");
        } catch (IOException ex) {
            Logger.getLogger(Dictionary.class.getName()).log(Level.SEVERE, null, ex);
        }
        txtNewEnglish.setText("");
        eNewVietnamese.setText("");
    }//GEN-LAST:event_bAddActionPerformed

    /**
     * Remove Function eInput : the English word is inputted
     *
     * @param evt
     */
    private void bRemoveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bRemoveActionPerformed
        lMessege.setText("");
        String eInput = txtEnglishInput.getText().trim();
        int choose = JOptionPane.showConfirmDialog(null, "Do U wanna update");
        switch (choose) {
            case 0:
                if (!eInput.isEmpty()) {
                    for (int i = 0; i < list.size(); i++) {
                        if (eInput.equals(list.get(i).getWord_target().trim())) {
                            list.remove(i);
                        }
                    }
                    lMessege.setText("Remove Successfully");
                    try {
                        dictionaryExportToFile("dictionary2.txt");
                    } catch (IOException ex) {
                        Logger.getLogger(Dictionary.class.getName()).log(Level.SEVERE, null, ex);
                    }
                } else {
                    lMessege.setText("Error");
                }   break;
            case 1:
                lMessege.setText("Stop Removing");
                break;
            default:
                lMessege.setText("Cancel Removing");
                break;
        }

        txtEnglishInput.setText("");
        eDictionary.setText("");

    }//GEN-LAST:event_bRemoveActionPerformed

    /**
     * Update Function eInput : the English word is inputted eNew : the English
     * word is updated vNew : the Vietnamese word is updated
     *
     * @param evt
     */
    private void bUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bUpdateActionPerformed
        lMessege.setText("");
        String eInput = txtEnglishInput.getText().trim();
        String eNew = txtNewEnglish.getText();
        String vNew = eNewVietnamese.getText();
        System.out.println("Data update 3: " + vNew.replaceAll("\\r\\n|\\r|\\n", " "));
        //System.out.println("Data update 4: " + v.replaceAll("\\r|\\n", ""));
        int choose = JOptionPane.showConfirmDialog(null, "Do U wanna update");
        if (!vNew.isEmpty() && !eNew.isEmpty()) {
            switch (choose) {
                case 0:
                    for (int i = 0; i < list.size(); i++) {
                        if (eInput.equals(list.get(i).getWord_target().trim())) {
                            list.set(i, new Word(eNew, vNew.replaceAll("\\r\\n|\\r|\\n", " ")));
                            break;
                        }
                    }
                    lMessege.setText("Update Successfully");
                    try {
                        dictionaryExportToFile("dictionary2.txt");
                    } catch (IOException ex) {
                        Logger.getLogger(Dictionary.class.getName()).log(Level.SEVERE, null, ex);
                    }
                    break;
                case 1:
                    lMessege.setText("Stop Updating");
                    break;
                default:
                    lMessege.setText("Cancel Updating");
                    break;
            }
        } else {
            lMessege.setText("Error");
        }

        txtNewEnglish.setText("");
        eNewVietnamese.setText("");
        txtEnglishInput.setText("");
        eDictionary.setText("");

    }//GEN-LAST:event_bUpdateActionPerformed
    private void bStartActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bStartActionPerformed
        try {
            insertFromFile("dictionary2.txt");
            lMessege.setText("Start Successfully");
        } catch (FileNotFoundException ex) {
            Logger.getLogger(Dictionary.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_bStartActionPerformed
    /**
     * SearcherMouseClicked Function ChoosedWord : the English Word is chosen
     * from the list of searcher
     *
     * @param evt
     */
    private void lSearcherMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lSearcherMouseClicked
        eDictionary.setText("");
        String ChosenWord = lSearcher.getSelectedValue().trim();
        dictionaryLookup(ChosenWord);
        lMessege.setText("");
    }//GEN-LAST:event_lSearcherMouseClicked
    /**
     * eDictionaryMouseClicked Function
     *
     * @param evt
     */
    private void eDictionaryMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_eDictionaryMouseClicked
        eNewVietnamese.setContentType("text/html");
        eNewVietnamese.setText(eDictionary.getText());
        txtNewEnglish.setText(txtEnglishInput.getText());

        //  txtInput.setText("");
        //  eDictionary.setText("");
        lMessege.setText("");
    }//GEN-LAST:event_eDictionaryMouseClicked
    private static final String VOICENAME = "kevin16";   
    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
       Voice voice;
       VoiceManager vm = VoiceManager.getInstance();
       voice = vm.getVoice(VOICENAME);
       voice.allocate();
       voice.speak(txtEnglishInput.getText());
    }//GEN-LAST:event_jButton1ActionPerformed

    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Dictionary.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>
        
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(() -> {
            new Dictionary().setVisible(true);
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton bAdd;
    private javax.swing.JButton bRemove;
    private javax.swing.JButton bSearcher;
    private javax.swing.JButton bStart;
    private javax.swing.JButton bTranslate;
    private javax.swing.JButton bUpdate;
    private javax.swing.JEditorPane eDictionary;
    private javax.swing.JEditorPane eNewVietnamese;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JLabel lMessege;
    private javax.swing.JList<String> lSearcher;
    private javax.swing.JTextField txtEnglishInput;
    private javax.swing.JTextField txtNewEnglish;
    // End of variables declaration//GEN-END:variables
}
